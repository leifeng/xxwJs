/*! xxwJs 2014-12-10 ZhangChl*/
define(["xxwOther"],function(a){"use strict";var b=function(a,c){return new b.prototype.init(a,c)};return b.prototype={init:function(a,b){a.resize&&this.resize(),a.scroll&&this.scroll(b),this.makeHtml(a)},makeHtml:function(a){var b=document.getElementById("xxw_waterfall");b||(b=document.createElement("div"),b.id="xxw_waterfall",document.body.appendChild(b));for(var c=0;c<a.list.length;c++){var d=a.list[c].src,e=(a.list[c].title,document.createElement("div")),f=document.createElement("div"),g=document.createElement("img");f.appendChild(g),e.appendChild(f),b.appendChild(e),e.className="xxw_waterfall_box",f.className="xxw_waterfall_pic",g.src=d}this.setStyle()},setStyle:function(){var b=document.getElementById("xxw_waterfall");this.oBoxs=a.getClass(b,"xxw_waterfall_box");var c=this.oBoxs[0].offsetWidth;this.nBox=Math.floor(a.clientWidth()/c),b.style.cssText="width:"+this.nBox*c+"px;",this.getColsH()},getColsH:function(){for(var a=[],b=0;b<this.oBoxs.length;b++)if(b<this.nBox)this.oBoxs[b].style.cssText="",a.push(this.oBoxs[b].offsetHeight);else{var c=Math.min.apply(null,a),d=this.getMinIndex(a,c);this.oBoxs[b].style.position="absolute",this.oBoxs[b].style.left=this.oBoxs[d].offsetLeft+"px",this.oBoxs[b].style.top=c+"px",a[d]+=this.oBoxs[b].offsetHeight}},getMinIndex:function(a,b){for(var c in a)if(a[c]===b)return c},resize:function(){var a,b=this;window.onresize=function(){clearTimeout(a),a=window.setTimeout(b.setStyle(),10)}},scroll:function(b){var c=this;window.onscroll=function(){var d=c.oBoxs[c.oBoxs.length-1].offsetTop+c.oBoxs[c.oBoxs.length-1].offsetHeight;d<=a.scrollTop()+a.clientHeight()&&b&&b()}}},b.prototype.init.prototype=b.prototype,b});