/*! xxwJs 2014-12-10 ZhangChl*/
define(["xxwOther","xxwAnimation"],function(a,b){"use strict";var c=function(a){return new c.prototype.init(a)};return c.prototype={init:function(b){var c={panel:null,background:["lightgreen","chocolate","royalblue"],navShow:!0,navColor:"lightgray",autoScroll:!1,rep:!1,afterScroll:null};this.opts=a.extend(c,b),this.main=a.$$(this.opts.panel),this.container=a.getClass(this.main,"xxw_fp_container")[0],this.nav=a.getFirstChild(this.main),this.pages=a.getClass(this.container,"xxw_fp_page"),this.index=0,this.navChild=[],this.makeHtml(),this.makeSize(),this.bindEvent()},makeHtml:function(){if(this.opts.afterScroll(this.index,this.pages[this.index]),this.opts.navShow)for(var a=0;a<this.pages.length;a++){this.pages[a].style.backgroundColor=this.opts.background[a];var b=document.createElement("a");this.nav.appendChild(b),b.innerHTML="&nbsp;",b.style.cssText="background-color:"+this.opts.navColor,this.navChild.push(b)}else this.nav.style.cssText="display:none"},makeSize:function(){var c=a.clientHeight();this.container.style.cssText="height:"+c+"px",b(this.container,{scrollTop:c*this.index});for(var d=0;d<this.pages.length;d++)this.pages[d].style.height=c+"px"},bindEvent:function(){var b=this;a.addEvent(window,"resize",function(){setTimeout(function(){b.makeSize.call(b,arguments)},400)}),a.addEvent(window,"keydown",function(c){c=a.fixEvent(c);var d=c.keyCode;40===d&&b.nextPage(),38==d&&b.prevPage()})},changeNav:function(){if(this.opts.navShow){for(var a=0;a<this.navChild.length;a++)this.navChild[a].style.cssText="background-color:"+this.opts.navColor;this.navChild[this.index].style.backgroundColor="red"}},nextPage:function(){var c=this;if(this.index!=this.pages.length-1){this.index++,this.index>this.pages.length-1&&(this.index=this.pages.length-1);var d=a.clientHeight();b(this.container,{scrollTop:d*this.index},c.opts.afterScroll(c.index,c.pages[c.index])),this.changeNav()}},prevPage:function(){var c=this;if(0!=this.index){this.index--,this.index<0&&(this.index=0);var d=a.clientHeight();b(this.container,{scrollTop:d*this.index},c.opts.afterScroll(c.index,c.pages[c.index])),this.changeNav()}}},c.prototype.init.prototype=c.prototype,c});